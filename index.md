# Git 入門

## Git とは

* ファイルのバージョン管理システムのひとつ
* 「分散型」の特徴を持つ
    * cf:「subversion」は中央集中型
    * サーバ不要・ローカルだけで完結
    * 他者と共有する場合はリモートリポジトリが必要
* リモートとのやりとりはまとめて行う
    * ローカルで commit & commit & commit ....
    * あとでまとめて追加！（push）
* とにかく速い！
* 賢い！
    * 適当にmergeしてもいい感じにやってくれる

### そもそもバージョン管理とはなんぞや

* テキストファイルについて、__行単位__で変更履歴を残す仕組み

* いつ・誰が・どのファイルに・どの行に・どのような変更を行ったのかを履歴に残す

* ある履歴へバージョンを戻す、ある履歴のみ適用する・撤去する などが可能

* 画像ファイルなどのテキストファイル以外のバージョン管理には不向き

    

## ことば

* __リポジトリ__
    * 実体はコミット(変更内容)の集合
    * 一般的には、バージョン管理する対象ブランチ群・ファイル群・変更内容一式をまとめて指す

* __ローカル（リポジトリ）__
* __リモート（リポジトリ）__

* __ブランチ__
    * ファイル群一式
    * 初期ブランチは「master」
    * 案件ごとに切り替えて使用する
* __コミット（ハッシュ）__
    * 変更内容のこと
    * git のコミットIDは 40文字のランダムな英数字(SHA-1ハッシュ)で表す
        * 例: ```43625a2de9c9913e099afa3bd62a88333f1f70d4```
        * リポジトリを超えて一意
    * 先頭の7文字でもOK
        * 例: ```43625a2```
    * git はコミットの集合で出来ている（ファイルがあるわけではない）



## 必須コマンド

### 設置系

* __git init__
    * ローカルに新規にリポジトリ作る・リポジトリの初期化
    * git remote add <remote のリポジトリURL> →  git push でremoteリポジトリ作成
* __git clone__
    * リモートリポジトリをとってくる
    * ```git clone <リモートリポジトリのURL> (現在のパス)```
        * 「現在のパス」を省略するとリポジトリ名が適用される
* __git checkout__
    * ローカルにてブランチを切り替える
    * 変更の取り消しにも使う

### ローカル系

#### 確認系

* __git branch __
    * 現在のブランチを確認する
    * -r つけると remote のブランチも確認
* __git status__
    * 現在の local の変更状態を確認する
* __git diff__
    * 現在の local の変更差分を確認する
    * その他、色々応用あり

* __git show__
    * コミットハッシュを指定して変更内容を確認する
        * ```git show コミットハッシュ```

* __git log__
    * 変更履歴を確認する
    * -p をつけると、差分付きで確認できる

#### 編集系

* __git add__
    * 現在の local の変更をコミット対象（インデックス）に追加する
* __git commit__
    * コミット対象（インデックス）に追加された変更を確定する（コミットする）
    * コミットメッセージは適切に指定すべし（後々助かる）
        * →「コミットメッセージ」の章を参照
* __その他__
    * git rm: ファイル削除(remove)
    * git mv: ファイル移動(move)

#### 管理・運用系

* __git merge__
    * 

### リモートやり取り系

* __git fetch__
    * remote の変更をまとめて local に持ってくる（反映はしない）
* __git pull__
    * ブランチを指定してremote の変更をとってきて、反映する
    * 例: remote の ブランチ「hoge」 を local の「hoge」 に反映する
        * ```git pull --rebase origin hoge```
* __git push__
    *  local の変更を remote に送る
    * 例: local の ブランチ「hoge」 を remote の「hoge」 に反映する
    * ```git remote origin hoge```

##### イメージ図


## 運用のコツ

####作業前には必ずリモートの変更をとってこよう！

* git pull --rebase する

#### コミット前に必ず差分を確認しよう！

* 意図しない変更は無いか？
* 改行コード・文字コードが変わっていないか？
* 変なインデント・不要な空白はないか？

##### 差分の確認方法

まとめ中

#### 適切なコミットメッセージを必ずつけよう！

ルールまとめ中

#### ちゃんとしたイケてるエディタを使おう！

まとめ中



## 運用ルール（git flow）

まとめ中



## 実際にやってみよう！

#### 1. ツールのインストール

* GUI（グラフィカルなツールで）
    * SourceTree
    * TortoiseGit
* CUI（コマンドで）
    * Git for Windows ※推奨

#### 2. remote リポジトリを local に持ってくる

* git clone

#### 3. 自分用のブランチを作ろう

* git checkout -b 新ブランチ名

#### 4. 変更しよう

* git diff

#### 5. コミットしよう

* git add / git commit

#### 6. remote に反映しよう

* git push

####7. メンバーの変更を merge しよう

* git merge



## 確認環境（pgit.be）

事前に登録したリポジトリの変更を、実際のパス構成でリアルタイムに確認可能な環境

※リポジトリ追加時は山田まで要連絡

#### ドメインのルール

* __サブドメイン__ 
    * 「リポジトリ識別子」と「変換したブランチ名」を「. (ドット)」で連結したもの
    * __変換したブランチ名__
        * ドメインに使用不可の文字（ / _ @ など）を「- (ハイフン)」に置換
        * 大文字は小文字に置換
* 例: リポジトリ「shop」のブランチ「feature/ACTION-123」のURL
    * http://shop.feature-action-123.pgit.be





